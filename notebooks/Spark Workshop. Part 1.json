{"paragraphs":[{"text":"import org.apache.spark._\nimport org.apache.spark.sql._\n\nimport spark.implicits._","user":"anonymous","dateUpdated":"2018-03-09T09:25:24+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark._\nimport org.apache.spark.sql._\nimport spark.implicits._\n"}]},"apps":[],"jobName":"paragraph_1520583471918_106297807","id":"20180302-150043_1447342835","dateCreated":"2018-03-09T08:17:51+0000","dateStarted":"2018-03-09T09:25:24+0000","dateFinished":"2018-03-09T09:25:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2360"},{"text":"val prefix = \"s3://commoncrawl/\"\nval wetPaths = spark.read.textFile(\"s3://commoncrawl/crawl-data/CC-MAIN-2018-09/wet.paths.gz\").take(10).map(prefix + _)","user":"anonymous","dateUpdated":"2018-03-09T09:25:24+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"prefix: String = s3://commoncrawl/\nwetPaths: Array[String] = Array(s3://commoncrawl/crawl-data/CC-MAIN-2018-09/segments/1518891807660.32/wet/CC-MAIN-20180217185905-20180217205905-00000.warc.wet.gz, s3://commoncrawl/crawl-data/CC-MAIN-2018-09/segments/1518891807660.32/wet/CC-MAIN-20180217185905-20180217205905-00001.warc.wet.gz, s3://commoncrawl/crawl-data/CC-MAIN-2018-09/segments/1518891807660.32/wet/CC-MAIN-20180217185905-20180217205905-00002.warc.wet.gz, s3://commoncrawl/crawl-data/CC-MAIN-2018-09/segments/1518891807660.32/wet/CC-MAIN-20180217185905-20180217205905-00003.warc.wet.gz, s3://commoncrawl/crawl-data/CC-MAIN-2018-09/segments/1518891807660.32/wet/CC-MAIN-20180217185905-20180217205905-00004.warc.wet.gz, s3://commoncrawl/crawl-data/CC-MAIN-2018-09/segments/1518891807660.32/wet/CC-MAIN-20180217185905-2018021720590..."}]},"apps":[],"jobName":"paragraph_1520583471921_115916530","id":"20180306-095333_1759895334","dateCreated":"2018-03-09T08:17:51+0000","dateStarted":"2018-03-09T09:25:25+0000","dateFinished":"2018-03-09T09:25:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2361"},{"text":"import com.martinkl.warc._\nimport com.martinkl.warc.mapreduce._\nimport org.apache.hadoop.io._\n\nval wetsRDD = sc.newAPIHadoopFile[LongWritable, WARCWritable, WARCInputFormat](wetPaths.mkString(\",\"))","user":"anonymous","dateUpdated":"2018-03-09T09:25:24+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.martinkl.warc._\nimport com.martinkl.warc.mapreduce._\nimport org.apache.hadoop.io._\nwetsRDD: org.apache.spark.rdd.RDD[(org.apache.hadoop.io.LongWritable, com.martinkl.warc.WARCWritable)] = s3://commoncrawl/crawl-data/CC-MAIN-2018-09/segments/1518891807660.32/wet/CC-MAIN-20180217185905-20180217205905-00000.warc.wet.gz,s3://commoncrawl/crawl-data/CC-MAIN-2018-09/segments/1518891807660.32/wet/CC-MAIN-20180217185905-20180217205905-00001.warc.wet.gz,s3://commoncrawl/crawl-data/CC-MAIN-2018-09/segments/1518891807660.32/wet/CC-MAIN-20180217185905-20180217205905-00002.warc.wet.gz,s3://commoncrawl/crawl-data/CC-MAIN-2018-09/segments/1518891807660.32/wet/CC-MAIN-20180217185905-20180217205905-00003.warc.wet.gz,s3://commoncrawl/crawl-data/CC-MAIN-2018-09/segments/1518891807660.32/wet/CC-MAIN-20180217185905-20180217205905-00004.warc.wet.gz,s3://commoncrawl/crawl-data/CC-MAIN-2018-0..."}]},"apps":[],"jobName":"paragraph_1520583471921_115916530","id":"20180306-100910_1548847375","dateCreated":"2018-03-09T08:17:51+0000","dateStarted":"2018-03-09T09:25:26+0000","dateFinished":"2018-03-09T09:25:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2362"},{"text":"wetsRDD.count()","user":"anonymous","dateUpdated":"2018-03-09T09:25:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res29: Long = 424978\n"}]},"apps":[],"jobName":"paragraph_1520584331900_-777440889","id":"20180309-083211_156199231","dateCreated":"2018-03-09T08:32:11+0000","dateStarted":"2018-03-09T09:25:27+0000","dateFinished":"2018-03-09T09:25:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2363"},{"text":"case class Record(uri: String, content: String)","user":"anonymous","dateUpdated":"2018-03-09T09:25:25+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defined class Record\n"}]},"apps":[],"jobName":"paragraph_1520583471921_115916530","id":"20180309-054550_1574744604","dateCreated":"2018-03-09T08:17:51+0000","dateStarted":"2018-03-09T09:25:28+0000","dateFinished":"2018-03-09T09:25:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2364"},{"text":"import scala.collection._\nimport scala.collection.immutable._\n\nval MinContentLength = 1000\nval CheckFirst = 500\nval EligibleCount = 100\n\ndef isEnglishTextNaive(s: String): Boolean = {\n    if (s.length < MinContentLength) {\n        false\n    } else {\n        var i = 0\n        var count = 0\n        while (i < CheckFirst && count < EligibleCount) {\n            val c = s.charAt(i)\n            if ('a' <= c && c <= 'z' || 'A' <= c && c <= 'Z' ) {\n               count = count + 1\n            }\n            i = i + 1\n        }\n        count >= EligibleCount\n    }\n}\n\nval test1 = Array.fill(11000)(\"a\").mkString(\"\")\nisEnglishTextNaive(test1)\n\nval test2 = Array.fill(1000)(\" \").mkString(\"\")\nisEnglishTextNaive(test2)\n\nval test1 = Array.fill(11000)(\"ц\").mkString(\"\")\nisEnglishTextNaive(test1)","user":"anonymous","dateUpdated":"2018-03-09T09:25:25+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import scala.collection._\nimport scala.collection.immutable._\nMinContentLength: Int = 1000\nCheckFirst: Int = 500\nEligibleCount: Int = 100\nisEnglishTextNaive: (s: String)Boolean\ntest1: String = aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa...res33: Boolean = true\ntest2: String = \"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ...res35: Boolean = false\ntest1: String = ццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццццц...res37: Boolean = false\n"}]},"apps":[],"jobName":"paragraph_1520583471921_115916530","id":"20180306-134607_1874607218","dateCreated":"2018-03-09T08:17:51+0000","dateStarted":"2018-03-09T09:25:44+0000","dateFinished":"2018-03-09T09:25:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2365"},{"text":"val recordsDS = wetsRDD\n .map { case (_, r) =>\n   val content =  new String(r.getRecord().getContent(), \"UTF-8\")\n   Record(uri = r.getRecord().getHeader().getTargetURI(), content)\n }\n .toDS()\n .repartition(100)\n .filter { r =>\n    isEnglishTextNaive(r.content)\n }","user":"anonymous","dateUpdated":"2018-03-09T09:25:25+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"recordsDS: org.apache.spark.sql.Dataset[Record] = [uri: string, content: string]\n"}]},"apps":[],"jobName":"paragraph_1520583471922_117070776","id":"20180307-132855_2037032516","dateCreated":"2018-03-09T08:17:51+0000","dateStarted":"2018-03-09T09:25:44+0000","dateFinished":"2018-03-09T09:25:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2366"},{"text":"recordsDS.show(10)","user":"anonymous","dateUpdated":"2018-03-09T09:25:25+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+\n|                 uri|             content|\n+--------------------+--------------------+\n|http://2wildflwer...|Sorry this model ...|\n|http://acuasafra....|De donde viene el...|\n|http://afiletta.c...|A Filetta : voix ...|\n|http://aircraftub...|aircraftube - His...|\n|http://alexiis-vo...|VOZ DE LA LUZ: NI...|\n|http://amuza.pl/h...|Hayley Westenra -...|\n|http://apimec.com...|Máy phun sơn YELI...|\n|http://arete.unim...|Metaphysics – Are...|\n|http://artscultur...|rise to the chall...|\n|http://at.simnams...|Cần bán gấp 09850...|\n+--------------------+--------------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1520583471922_117070776","id":"20180306-135301_1872951519","dateCreated":"2018-03-09T08:17:51+0000","dateStarted":"2018-03-09T09:25:47+0000","dateFinished":"2018-03-09T09:26:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2367"},{"text":"recordsDS\n  .write\n  .mode(SaveMode.Overwrite)\n  .parquet(\"s3://workshop-lviv/data/ds-lang-naive/\")","user":"anonymous","dateUpdated":"2018-03-09T09:25:25+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1520583471923_116686028","id":"20180307-144243_582546177","dateCreated":"2018-03-09T08:17:51+0000","dateStarted":"2018-03-09T09:25:47+0000","dateFinished":"2018-03-09T09:27:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2368"},{"text":"import com.optimaize.langdetect.LanguageDetectorBuilder\nimport com.optimaize.langdetect.ngram.NgramExtractors\nimport com.optimaize.langdetect.profiles.LanguageProfileReader\nimport com.optimaize.langdetect.text.CommonTextObjectFactories\n\nval recordsDS1 = wetsRDD\n .repartition(100)\n .mapPartitions { it =>\n    val languageProfiles = new LanguageProfileReader().readAllBuiltIn()\n    val languageDetector = LanguageDetectorBuilder.create(NgramExtractors.standard).withProfiles(languageProfiles).build\n    val textObjectFactory = CommonTextObjectFactories.forDetectingOnLargeText\n    \n    def isEnglish(text: String) = {\n        val textObject = textObjectFactory.forText(text)\n        val ps = languageDetector.getProbabilities(textObject)\n        !ps.isEmpty && ps.get(0).getLocale.getLanguage == \"en\"\n    }\n    \n    it.flatMap { case (_, r) =>\n       val content = new String(r.getRecord().getContent(), \"UTF-8\") \n       if (content.length >= MinContentLength && isEnglish(content)) {\n           Some(Record(uri = r.getRecord().getHeader().getTargetURI(), content))\n       } else {\n           None\n       }\n    }\n }\n .toDS()","user":"anonymous","dateUpdated":"2018-03-09T09:25:25+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.optimaize.langdetect.LanguageDetectorBuilder\nimport com.optimaize.langdetect.ngram.NgramExtractors\nimport com.optimaize.langdetect.profiles.LanguageProfileReader\nimport com.optimaize.langdetect.text.CommonTextObjectFactories\nrecordsDS1: org.apache.spark.sql.Dataset[Record] = [uri: string, content: string]\n"}]},"apps":[],"jobName":"paragraph_1520583471923_116686028","id":"20180309-053451_1573508842","dateCreated":"2018-03-09T08:17:51+0000","dateStarted":"2018-03-09T09:26:01+0000","dateFinished":"2018-03-09T09:27:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2369"},{"text":"recordsDS.count()","user":"anonymous","dateUpdated":"2018-03-09T09:27:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res41: Long = 297306\n"}]},"apps":[],"jobName":"paragraph_1520583846197_-1508774095","id":"20180309-082406_1101510239","dateCreated":"2018-03-09T08:24:06+0000","dateStarted":"2018-03-09T09:27:03+0000","dateFinished":"2018-03-09T09:27:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2370"},{"text":"recordsDS1.count()","user":"anonymous","dateUpdated":"2018-03-09T09:25:25+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res42: Long = 182726\n"}]},"apps":[],"jobName":"paragraph_1520583471923_116686028","id":"20180309-060614_189789641","dateCreated":"2018-03-09T08:17:51+0000","dateStarted":"2018-03-09T09:27:04+0000","dateFinished":"2018-03-09T09:28:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2371"},{"text":"recordsDS1\n  .coalesce(10)\n  .write\n  .mode(SaveMode.Overwrite)\n  .parquet(\"s3://workshop-lviv/data/ds1/\")","user":"anonymous","dateUpdated":"2018-03-09T09:25:25+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1520583471923_116686028","id":"20180309-054904_1297758949","dateCreated":"2018-03-09T08:17:51+0000","dateStarted":"2018-03-09T09:27:20+0000","dateFinished":"2018-03-09T09:30:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2372"},{"text":"val test = spark.read.parquet(\"s3://workshop-lviv/data/ds1/\")\ntest.show(10)","user":"anonymous","dateUpdated":"2018-03-09T09:25:25+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{"1":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"test: org.apache.spark.sql.DataFrame = [uri: string, content: string]\n+--------------------+--------------------+\n|                 uri|             content|\n+--------------------+--------------------+\n|http://24mn--minn...|Nissan Key Servic...|\n|http://allaboutla...|All About Labels ...|\n|http://articles.s...|'Project Roots' h...|\n|http://atari-foru...|Atari-Forum - Log...|\n|http://austin-cop...|Email Marketing |...|\n|http://baybrookfu...|月曜と木曜はディスプレイチェーーン...|\n|http://beautyexch...|眉毛又有新玩法？唔玩「波浪」今次玩...|\n|http://bestgeekev...|Conglaturations! ...|\n|http://blog.luxur...|1233 Mauldin Circ...|\n|http://blogmarks....|Blogmarks : Publi...|\n+--------------------+--------------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1520583471923_116686028","id":"20180307-155144_880378056","dateCreated":"2018-03-09T08:17:51+0000","dateStarted":"2018-03-09T09:28:28+0000","dateFinished":"2018-03-09T09:31:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2373"},{"text":"val sampleDS = recordsDS\n  .sample(true, 0.2)\n  .cache()","user":"anonymous","dateUpdated":"2018-03-09T09:25:25+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"sampleDS: org.apache.spark.sql.Dataset[Record] = [uri: string, content: string]\n"}]},"apps":[],"jobName":"paragraph_1520583471924_114762283","id":"20180308-161233_1986251360","dateCreated":"2018-03-09T08:17:51+0000","dateStarted":"2018-03-09T09:31:00+0000","dateFinished":"2018-03-09T09:31:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2374"},{"dateUpdated":"2018-03-09T08:17:51+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1520583471924_114762283","id":"20180308-161613_585284889","dateCreated":"2018-03-09T08:17:51+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2375"}],"name":"Spark Workshop. Part 1","id":"2DA8DE1PF","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}